(21:23) (21:23) Server is running...
(21:23) Received: login pato
(21:23) Sent: user server update pato 
(21:23) Received: all dsf  
(21:23) Sent: all pato (21:23): all dsf  
(21:23) Received: login matz
(21:23) Sent: user server update pato matz 
(21:23) Received: all hola  
(21:23) Sent: all matz (21:23): all hola  
(21:23) Received: all como va 
(21:23) Sent: all matz (21:23): all como va 
(21:23) Received: all bien  
(21:23) Sent: all matz (21:23): all bien  
(21:23) Received: all vvos?  
(21:23) Sent: all matz (21:23): all vvos?  
(21:23) Received: all wvv  
(21:23) Sent: all pato (21:23): all wvv  
(21:23) Received: login papa
(21:23) Sent: user server update pato matz papa 
(21:23) Received: login mama
(21:23) Sent: user server update pato matz papa mama 
(21:23) Received: all jolaaaa  
(21:23) Sent: all mama (21:23): all jolaaaa  
(21:23) Received: all a todos 
(21:23) Sent: all mama (21:23): all a todos 
(21:23) Received: all shssh  
(21:23) Sent: all mama (21:23): all shssh  
(21:24) Received: all hfghfg  
(21:24) Sent: all papa (21:24): all hfghfg  
(21:24) Received: all jkljkl  
(21:24) Sent: all matz (21:24): all jkljkl  
(21:24) Received: all dfg  
(21:24) Sent: all matz (21:24): all dfg  
(21:24) Received: all fdfd  
(21:24) Sent: all pato (21:24): all fdfd  
(21:25) Sent: Connection: pato has disconnected.
(21:25) Sent: user server update matz papa mama 
(21:25) Received: all jkl  
(21:25) Sent: all matz (21:25): all jkl  
(21:25) Sent: Connection: matz has disconnected.
(21:25) Sent: user server update papa mama 
(21:25) Sent: Connection: papa has disconnected.
(21:25) Sent: user server update mama 
(21:25) Received: login pepo
(21:25) Sent: user server update mama pepo 
(21:26) Sent: Connection: pepo has disconnected.
(21:26) Sent: user server update mama 
(21:28) Sent: Connection: mama has disconnected.
(21:28) Received: login pato
(21:28) Sent: user server update pato 
(21:28) Received: login matz
(21:28) Sent: user server update pato matz 
(21:28) Received: login pepe
(21:28) Sent: user server update pato matz pepe 
(21:28) Received: login locazo
(21:28) Sent: user server update pato matz pepe locazo 
(21:28) Sent: Connection: matz has disconnected.
(21:28) Sent: user server update pato pepe locazo 
(21:28) Sent: Connection: locazo has disconnected.
(21:28) Sent: user server update pato pepe 
(21:28) Sent: Connection: pepe has disconnected.
(21:28) Sent: user server update pato 
(21:28) Sent: Connection: pato has disconnected.
(21:34) Received: login pato
(21:34) Sent: user server update pato 
(21:34) Received: all hola  
(21:34) Sent: all pato (21:34): all hola  
(21:34) Sent: Connection: pato has disconnected.
(21:34) Received: login PATO
(21:34) Sent: user server update PATO 
(21:35) Sent: Connection: PATO has disconnected.
(21:35) Received: login pato
(21:35) Sent: user server update pato 
(21:35) Received: all hola  
(21:35) Sent: all pato (21:35): all hola  
(21:35) Sent: Connection: pato has disconnected.
(21:36) Received: login PATO
(21:36) Sent: user server update PATO 
(21:36) Sent: Connection: PATO has disconnected.
(21:38) Received: login pato
(21:38) Sent: user server update pato 
(21:38) Received: all ada  
(21:38) Sent: all pato (21:38): all ada  
(21:38) Received: all como va personas
(21:38) Sent: all pato (21:38): all como va personas
(21:38) Sent: Connection: pato has disconnected.
(21:39) Received: login pato
(21:39) Sent: user server update pato 
(21:39) Sent: Connection: pato has disconnected.
(21:39) Received: login pato
(21:39) Sent: user server update pato 
(21:39) Received: all asd  
(21:39) Sent: all pato (21:39): all asd  
(21:39) Received: all asdas  
(21:39) Sent: all pato (21:39): all asdas  
(21:39) Received: all das  
(21:39) Sent: all pato (21:39): all das  
(21:39) Received: all das  
(21:39) Sent: all pato (21:39): all das  
(21:40) Received: all das  
(21:40) Sent: all pato (21:40): all das  
(21:40) Received: all sdsr32  
(21:40) Sent: all pato (21:40): all sdsr32  
(21:40) Received: all das  
(21:40) Sent: all pato (21:40): all das  
(21:40) Received: all jkh  
(21:40) Sent: all pato (21:40): all jkh  
(21:40) Received: all 'jhkjh  
(21:40) Sent: all pato (21:40): all 'jhkjh  
(21:40) Received: all ';jh'jh;jh;'kjhk  
(21:40) Sent: all pato (21:40): all ';jh'jh;jh;'kjhk  
(21:40) Received: all jhk;  
(21:40) Sent: all pato (21:40): all jhk;  
(21:40) Received: all h;kjh  
(21:40) Sent: all pato (21:40): all h;kjh  
(21:40) Received: all 'kjh;k  
(21:40) Sent: all pato (21:40): all 'kjh;k  
(21:40) Received: all 'jh;  
(21:40) Sent: all pato (21:40): all 'jh;  
(21:40) Received: all k  
(21:40) Sent: all pato (21:40): all k  
(21:40) Sent: Connection: pato has disconnected.
(22:13) Received: login pato
(22:13) Sent: user server update pato 
(22:13) Received: all asasd  
(22:13) Sent: all pato (22:13): all asasd  
(22:13) Received: all as  
(22:13) Sent: all pato (22:13): all as  
(22:13) Received: all asd  
(22:13) Sent: all pato (22:13): all asd  
(22:13) Received: all as  
(22:13) Sent: all pato (22:13): all as  
(22:13) Received: all as  
(22:13) Sent: all pato (22:13): all as  
(22:13) Sent: Connection: pato has disconnected.
(22:15) Received: login pato
(22:15) Sent: user server update pato 
(22:15) Received: all ghh  
(22:15) Sent: all pato (22:15): all ghh  
(22:15) Received: all ujh  
(22:15) Sent: all pato (22:15): all ujh  
(22:15) Received: all gjk  
(22:15) Sent: all pato (22:15): all gjk  
(22:15) Sent: Connection: pato has disconnected.
(22:16) Received: login pato
(22:16) Sent: user server update pato 
(22:16) Received: all asdoaskas asd asd asa
(22:16) Sent: all pato (22:16): all asdoaskas asd asd asa
(22:16) Sent: Connection: pato has disconnected.
(22:16) Received: login pato
(22:16) Sent: user server update pato 
(22:16) Received: all fgdfdg fdg fdg fdg fdg fd
(22:16) Sent: all pato (22:16): all fgdfdg fdg fdg fdg fdg fd
(22:16) Sent: Connection: pato has disconnected.
(22:16) Received: login pato
(22:16) Sent: user server update pato 
(22:16) Received: all fdsf sf ds fsf dsf
(22:16) Sent: all pato (22:16): all fdsf sf ds fsf dsf
(22:16) Received: all tyfghjghfg fgh fgghdff
(22:16) Sent: all pato (22:16): all tyfghjghfg fgh fgghdff
(22:16) Sent: Connection: pato has disconnected.
(22:17) Received: login pato
(22:17) Sent: user server update pato 
(22:17) Received: all sdasadsads  
(22:17) Sent: all pato (22:17): all sdasadsads  
(22:17) Received: all  ad sa adsd asd adsd asd s
(22:17) Sent: all pato (22:17): all  ad sa adsd asd adsd asd s
(22:17) Received: all ad sa adsd asd adsd asd s
(22:17) Sent: all pato (22:17): all ad sa adsd asd adsd asd s
(22:17) Sent: Connection: pato has disconnected.
(22:20) Received: login pato
(22:20) Sent: user server update pato 
(22:20) Received: all   fgfd
(22:20) Sent: all pato (22:20): all   fgfd
(22:20) Sent: Connection: pato has disconnected.
(22:22) Received: login pato
(22:22) Sent: user server update pato 
(22:22) Sent: Connection: pato has disconnected.
(22:23) Received: login pato
(22:23) Sent: user server update pato 
(22:23) Sent: Connection: pato has disconnected.
(22:23) Received: login PATO
(22:23) Sent: user server update PATO 
(22:23) Sent: Connection: PATO has disconnected.
(22:24) Received: login pato
(22:24) Sent: user server update pato 
(22:24) Sent: Connection: pato has disconnected.
(22:25) Received: login pato
(22:25) Sent: user server update pato 
(22:25) Sent: Connection: pato has disconnected.
(22:25) Received: login pato
(22:25) Sent: user server update pato 
(22:25) Sent: Connection: pato has disconnected.
(22:25) Received: login pato
(22:25) Sent: user server update pato 
(22:25) Sent: Connection: pato has disconnected.
(22:26) Received: login Matz
(22:26) Sent: user server update Matz 
(22:26) Sent: Connection: Matz has disconnected.
(22:30) Received: login pato
(22:30) Sent: user server update pato 
(22:30) Received: all asdasd  
(22:30) Sent: all pato (22:30): all asdasd  
(22:30) Received: all 
ddsfffds  
(22:30) Sent: all pato (22:30): all 
ddsfffds  
(22:30) Received: all 
gffg  
(22:30) Sent: all pato (22:30): all 
gffg  
(22:30) Received: all jkljl  
(22:30) Sent: all pato (22:30): all jkljl  
(22:30) Sent: Connection: pato has disconnected.
(22:30) Received: login pato
(22:30) Sent: user server update pato 
(22:30) Received: all adsas  
(22:30) Sent: all pato (22:30): all adsas  
(22:30) Sent: Connection: pato has disconnected.
(22:31) Received: login pato
(22:31) Sent: user server update pato 
(22:31) Received: all adads  
(22:31) Sent: all pato (22:31): all adads  
(22:31) Received: all asdasdfgdfgd  
(22:31) Sent: all pato (22:31): all asdasdfgdfgd  
(22:31) Received: all fgfgh  
(22:31) Sent: all pato (22:31): all fgfgh  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Received: all 
  
(22:31) Sent: all pato (22:31): all 
  
(22:31) Sent: Connection: pato has disconnected.
(22:31) Received: login pato
(22:31) Sent: user server update pato 
(22:31) Received: all asdas  
(22:31) Sent: all pato (22:31): all asdas  
(22:31) Received: all fghfgh  
(22:31) Sent: all pato (22:31): all fghfgh  
(22:31) Received: all fghfgfgh  
(22:31) Sent: all pato (22:31): all fghfgfgh  
(22:31) Received: all fghfgdsdsf  
(22:31) Sent: all pato (22:31): all fghfgdsdsf  
(22:31) Received: all dsfdsfdsff  
(22:31) Sent: all pato (22:31): all dsfdsfdsff  
(22:31) Sent: Connection: pato has disconnected.
(22:32) Received: login pato
(22:32) Sent: user server update pato 
(22:32) Received: all asdasd  
(22:32) Sent: all pato (22:32): all asdasd  
(22:32) Received: all asdasdadsdas  
(22:32) Sent: all pato (22:32): all asdasdadsdas  
(22:32) Received: all hola como va
(22:32) Sent: all pato (22:32): all hola como va
(22:32) Received: all a  
(22:32) Sent: all pato (22:32): all a  
(22:32) Sent: Connection: pato has disconnected.
(22:32) Received: login pato
(22:32) Sent: user server update pato 
(22:32) Received: all asdasdas  
(22:32) Sent: all pato (22:32): all asdasdas  
(22:32) Received: all asdasfghfgh  
(22:32) Sent: all pato (22:32): all asdasfghfgh  
(22:32) Received: all fghjjghg  
(22:32) Sent: all pato (22:32): all fghjjghg  
(22:32) Received: all hj  
(22:32) Sent: all pato (22:32): all hj  
(22:32) Received: all ghj  
(22:32) Sent: all pato (22:32): all ghj  
(22:32) Received: all gh  
(22:32) Sent: all pato (22:32): all gh  
(22:32) Received: all jgh  
(22:32) Sent: all pato (22:32): all jgh  
(22:32) Received: all j  
(22:32) Sent: all pato (22:32): all j  
(22:32) Received: all ghj  
(22:32) Sent: all pato (22:32): all ghj  
(22:32) Received: all gh  
(22:32) Sent: all pato (22:32): all gh  
(22:32) Sent: Connection: pato has disconnected.
(22:34) Received: login pato
(22:34) Sent: user server update pato 
(22:34) Received: all asdsa  
(22:34) Sent: all pato (22:34): all asdsa  
(22:34) Sent: Connection: pato has disconnected.
(22:34) Received: login pato
(22:34) Sent: user server update pato 
(22:34) Received: all 


hola como va
(22:34) Sent: all pato (22:34): all 


hola como va
(22:34) Received: all hola

		como va 
(22:34) Sent: all pato (22:34): all hola

		como va 
(22:34) Received: all 
hola
		como va 
(22:34) Sent: all pato (22:34): all 
hola
		como va 
(22:35) Sent: Connection: pato has disconnected.
(22:35) Received: login pato
(22:35) Sent: user server update pato 
(22:35) Received: all 

hola

		como va 
(22:35) Sent: all pato (22:35): all 

hola

		como va 
(22:35) Received: all private int() {
	todos putos;
}
(22:35) Sent: all pato (22:35): all private int() {
	todos putos;
}
(22:37) Received: all 1
2
3
4
5
6
7
8
9		holaaa  
(22:37) Sent: all pato (22:37): all 1
2
3
4
5
6
7
8
9		holaaa  
(22:37) Sent: Connection: pato has disconnected.
(22:39) Received: login pato
(22:39) Sent: user server update pato 
(22:39) Received: all 1	2	3	4  
(22:39) Sent: all pato (22:39): all 1	2	3	4  
(22:39) Received: all 1	2	3	4	5	6	7	8	9	10  
(22:39) Sent: all pato (22:39): all 1	2	3	4	5	6	7	8	9	10  
(22:39) Sent: Connection: pato has disconnected.
(22:39) Received: login pato
(22:39) Sent: user server update pato 
(22:39) Received: all 1	1	1	1	1	1	  
(22:39) Sent: all pato (22:39): all 1	1	1	1	1	1	  
(22:39) Received: all 
1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1  
(22:39) Sent: all pato (22:39): all 
1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1  
(22:40) Sent: Connection: pato has disconnected.
(22:43) Received: login pato
(22:43) Sent: user server update pato 
(22:43) Received: all asdas
asdas
d
asd
as  
(22:43) Sent: all pato (22:43): all asdas
asdas
d
asd
as  
(22:43) Received: all 
da

dssadasd  
(22:43) Sent: all pato (22:43): all 
da

dssadasd  
(22:43) Received: all 
asd
as
das
da
sd
asd  
(22:43) Sent: all pato (22:43): all 
asd
as
das
da
sd
asd  
(22:43) Received: all 
as
das
das
d
as
das
das
ds
ads  
(22:43) Sent: all pato (22:43): all 
as
das
das
d
as
das
das
ds
ads  
(22:43) Received: all 
ad
sa
da
s
a
asdasdasdasd  
(22:43) Sent: all pato (22:43): all 
ad
sa
da
s
a
asdasdasdasd  
(22:43) Received: all 
a
dasdasdasdasdad  
(22:43) Sent: all pato (22:43): all 
a
dasdasdasdasdad  
(22:43) Received: all 
asdasdiodjasd  
(22:43) Sent: all pato (22:43): all 
asdasdiodjasd  
(22:43) Received: all 
as  
(22:43) Sent: all pato (22:43): all 
as  
(22:43) Received: all ad  
(22:43) Sent: all pato (22:43): all ad  
(22:43) Sent: Connection: pato has disconnected.
(22:44) Received: login pato
(22:44) Sent: user server update pato 
(22:44) Received: all 
  
(22:44) Sent: all pato (22:44): all 
  
(22:44) Received: all 

  
(22:44) Sent: all pato (22:44): all 

  
(22:44) Received: all 

  
(22:44) Sent: all pato (22:44): all 

  
(22:44) Sent: Connection: pato has disconnected.
(22:50) Received: login pato
(22:50) Sent: user server update pato 
(22:50) Received: all 


  
(22:50) Sent: all pato (22:50): all 


  
(22:50) Sent: Connection: pato has disconnected.
(22:58) Received: login pato
(22:58) Sent: user server update pato 
(22:58) Received: all 
  
(22:58) Sent: all pato (22:58): all 
  
(22:58) Received: all 
  
(22:58) Sent: all pato (22:58): all 
  
(22:58) Received: all 
  
(22:58) Sent: all pato (22:58): all 
  
(22:58) Received: all 
  
(22:58) Sent: all pato (22:58): all 
  
(22:58) Received: all 



  
(22:58) Sent: all pato (22:58): all 



  
(22:58) Received: all 






  
(22:58) Sent: all pato (22:58): all 






  
(22:58) Received: all 





  
(22:58) Sent: all pato (22:58): all 





  
(22:58) Received: all 


  
(22:58) Sent: all pato (22:58): all 


  
(22:58) Received: all 




  
(22:58) Sent: all pato (22:58): all 




  
(22:58) Sent: Connection: pato has disconnected.
(22:58) Received: login pato
(22:58) Sent: user server update pato 
(22:58) Received: all 

adasas  
(22:58) Sent: all pato (22:58): all 

adasas  
(22:58) Received: all 
das

adasd  
(22:58) Sent: all pato (22:58): all 
das

adasd  
(22:58) Received: all asdasdas  
(22:58) Sent: all pato (22:58): all asdasdas  
(22:58) Received: all 
asdasasd  
(22:58) Sent: all pato (22:58): all 
asdasasd  
(22:58) Sent: Connection: pato has disconnected.
(22:59) Received: login pato
(22:59) Sent: user server update pato 
(22:59) Received: all 
  
(22:59) Sent: all pato (22:59): all 
  
(22:59) Received: all 
  
(22:59) Sent: all pato (22:59): all 
  
(22:59) Sent: Connection: pato has disconnected.
(22:59) Received: login pato
(22:59) Sent: user server update pato 
(22:59) Received: all 
asdads  
(22:59) Sent: all pato (22:59): all 
asdads  
(22:59) Received: all 
  
(22:59) Sent: all pato (22:59): all 
  
(22:59) Received: all 
  
(22:59) Sent: all pato (22:59): all 
  
(22:59) Received: all 
  
(22:59) Sent: all pato (22:59): all 
  
(22:59) Sent: Connection: pato has disconnected.
(22:59) Received: login pato
(22:59) Sent: user server update pato 
(23:00) Received: all asdasdas  
(23:00) Sent: all pato (23:00): all asdasdas  
(23:00) Received: all asdasads  
(23:00) Sent: all pato (23:00): all asdasads  
(23:00) Sent: Connection: pato has disconnected.
(23:00) Received: login pato
(23:00) Sent: user server update pato 
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Received: all 
  
(23:00) Sent: all pato (23:00): all 
  
(23:00) Sent: Connection: pato has disconnected.
(23:00) Received: login pato
(23:00) Sent: user server update pato 
(23:00) Received: all patoar  
(23:00) Sent: all pato (23:00): all patoar  
(23:00) Sent: Connection: pato has disconnected.
(23:01) Received: login pato
(23:01) Sent: user server update pato 
(23:01) Received: all 
  
(23:01) Sent: all pato (23:01): all 
  
(23:01) Received: all 
  
(23:01) Sent: all pato (23:01): all 
  
(23:01) Received: all 
  
(23:01) Sent: all pato (23:01): all 
  
(23:01) Sent: Connection: pato has disconnected.
(23:01) Received: login pato
(23:01) Sent: user server update pato 
(23:01) Received: all 
  
(23:01) Sent: all pato (23:01): all 
  
(23:01) Received: all 
  
(23:01) Sent: all pato (23:01): all 
  
(23:01) Sent: Connection: pato has disconnected.
(23:01) Received: login pato
(23:01) Sent: user server update pato 
(23:01) Received: all asdalkasd  
(23:01) Sent: all pato (23:01): all asdalkasd  
(23:01) Sent: Connection: pato has disconnected.
(23:02) Received: login pato
(23:02) Sent: user server update pato 
(23:02) Received: all asdasdas  
(23:02) Sent: all pato (23:02): all asdasdas  
(23:02) Received: all asdsadaskj asd 
(23:02) Sent: all pato (23:02): all asdsadaskj asd 
(23:02) Sent: Connection: pato has disconnected.
(23:02) Received: login pato
(23:02) Sent: user server update pato 
(23:02) Received: all 
  
(23:02) Sent: all pato (23:02): all 
  
(23:02) Received: all 
  
(23:02) Sent: all pato (23:02): all 
  
(23:02) Received: all 
  
(23:02) Sent: all pato (23:02): all 
  
(23:02) Received: all 
asdas  
(23:02) Sent: all pato (23:02): all 
asdas  
(23:02) Sent: Connection: pato has disconnected.
(23:03) Received: login pato
(23:03) Sent: user server update pato 
(23:03) Received: all 
  
(23:03) Sent: all pato (23:03): all 
  
(23:03) Received: all 
  
(23:03) Sent: all pato (23:03): all 
  
(23:03) Received: all 
asd  
(23:03) Sent: all pato (23:03): all 
asd  
(23:03) Received: all 
asdadadasd  
(23:03) Sent: all pato (23:03): all 
asdadadasd  
(23:03) Sent: Connection: pato has disconnected.
(23:03) Received: login pato
(23:03) Sent: user server update pato 
(23:03) Received: all adssa  
(23:03) Sent: all pato (23:03): all adssa  
(23:03) Received: all asasas  
(23:03) Sent: all pato (23:03): all asasas  
(23:03) Sent: Connection: pato has disconnected.
(23:06) Received: login pato
(23:06) Sent: user server update pato 
(23:06) Received: all 

asdas  
(23:06) Sent: all pato (23:06): all 

asdas  
(23:06) Received: all 

holaaa  
(23:06) Sent: all pato (23:06): all 

holaaa  
(23:06) Received: all como va 
(23:06) Sent: all pato (23:06): all como va 
(23:06) Received: all asdasd  
(23:06) Sent: all pato (23:06): all asdasd  
(23:06) Sent: Connection: pato has disconnected.
(23:06) Received: login pato
(23:06) Sent: user server update pato 
(23:06) Received: all 
asdads  
(23:06) Sent: all pato (23:06): all 
asdads  
(23:06) Received: all pato como va
(23:06) Sent: all pato (23:06): all pato como va
(23:06) Sent: Connection: pato has disconnected.
(23:06) Received: login pato
(23:06) Sent: user server update pato 
(23:06) Received: all 


adas  
(23:06) Sent: all pato (23:06): all 


adas  
(23:06) Received: all 


dggfhty  
(23:06) Sent: all pato (23:06): all 


dggfhty  
(23:06) Received: all ghjjghghj


  
(23:06) Sent: all pato (23:06): all ghjjghghj


  
(23:06) Sent: Connection: pato has disconnected.
(23:07) Received: login pato
(23:07) Sent: user server update pato 
(23:07) Received: login pato
(23:07) Sent: Connection: pato has disconnected.
(23:07) Received: login pato
(23:07) Sent: user server update pato 
(23:07) Received: all hola  
(23:07) Sent: all pato (23:07): all hola  
(23:07) Received: all 

  
(23:07) Sent: all pato (23:07): all 

  
(23:07) Received: all como va 
(23:07) Sent: all pato (23:07): all como va 
(23:08) Sent: Connection: pato has disconnected.
(23:08) Received: login pato
(23:08) Sent: user server update pato 
(23:08) Received: all holaa  
(23:08) Sent: all pato (23:08): all holaa  
(23:08) Received: all 


hola asdas 
(23:08) Sent: all pato (23:08): all 


hola asdas 
(23:09) Received: all fgfgdfgd  
(23:09) Sent: all pato (23:09): all fgfgdfgd  
(23:09) Received: all hola  
(23:09) Sent: all pato (23:09): all hola  
(23:09) Received: all asdasdasdasdas  
(23:09) Sent: all pato (23:09): all asdasdasdasdas  
(23:09) Received: all asdasdasdasdasdas  
(23:09) Sent: all pato (23:09): all asdasdasdasdasdas  
(23:09) Received: all dasdasdasdasdsadasd  
(23:09) Sent: all pato (23:09): all dasdasdasdasdsadasd  
(23:09) Received: all sadretrettrtytyu  
(23:09) Sent: all pato (23:09): all sadretrettrtytyu  
(23:09) Received: all tyutyuuiuiouioui  
(23:09) Sent: all pato (23:09): all tyutyuuiuiouioui  
(23:09) Received: all ouiui

dgfdgfdu sfksjdfdsf 
(23:09) Sent: all pato (23:09): all ouiui

dgfdgfdu sfksjdfdsf 
(23:09) Received: all oasiasd
asdkljfdgfd
sdgkljgd  
(23:09) Sent: all pato (23:09): all oasiasd
asdkljfdgfd
sdgkljgd  
(23:09) Received: all ouiui

dgfdgfdu sfksjdfdsf 
(23:09) Sent: all pato (23:09): all ouiui

dgfdgfdu sfksjdfdsf 
(23:09) Received: all iasjasd
ffjdgfd
fdkdgjfd e er3 	32	325
sdfgdskj	32436778 esf
(23:09) Sent: all pato (23:09): all iasjasd
ffjdgfd
fdkdgjfd e er3 	32	325
sdfgdskj	32436778 esf
(23:09) Received: all iasjasd
ffjdgfd
fdkdgjfd e er3 	32	325
sdfgdskj	32436778 esf
(23:09) Sent: all pato (23:09): all iasjasd
ffjdgfd
fdkdgjfd e er3 	32	325
sdfgdskj	32436778 esf
(23:09) Sent: Connection: pato has disconnected.
(23:11) Received: login pato
(23:11) Sent: user server update pato 
(23:11) Received: all hola  
(23:11) Sent: all pato (23:11): all hola  
(23:11) Received: all  como va
(23:11) Sent: all pato (23:11): all  como va
(23:11) Received: all aja  
(23:11) Sent: all pato (23:11): all aja  
(23:11) Sent: Connection: pato has disconnected.
(23:11) Received: login pato
(23:11) Sent: user server update pato 
(23:11) Received: all ola  
(23:11) Sent: all pato (23:11): all ola  
(23:11) Received: all jkljkl  
(23:11) Sent: all pato (23:11): all jkljkl  
(23:11) Sent: Connection: pato has disconnected.
(23:15) Received: login pato
(23:15) Sent: user server update pato 
(23:15) Received: all hola  
(23:15) Sent: all pato (23:15): all hola  
(23:15) Received: all como va 
(23:15) Sent: all pato (23:15): all como va 
(23:15) Sent: Connection: pato has disconnected.
(23:15) Received: login pato
(23:15) Sent: user server update pato 
(23:15) Received: all hola  
(23:15) Sent: all pato (23:15): all hola  
(23:15) Received: all como va 
(23:15) Sent: all pato (23:15): all como va 
(23:15) Received: all ajaja  
(23:15) Sent: all pato (23:15): all ajaja  
(23:15) Sent: Connection: pato has disconnected.
(23:16) Sent: Connection: Unknown user disconnected.
(23:16) Received: login pato
(23:16) Sent: user server update pato 
(23:16) Received: all hola  
(23:16) Sent: all pato (23:16): all hola  
(23:16) Received: all como va 
(23:16) Sent: all pato (23:16): all como va 
(23:17) Received: login matz
(23:17) Sent: user server update pato matz 
(23:17) Received: all aaajasd  
(23:17) Sent: all matz (23:17): all aaajasd  
(23:17) Received: /w pato asads
(23:17) Sent: pato matz (23:17): /w pato asads
(23:17) Received: /w pato fghfgf
(23:17) Received: /w matz wewerwe
(23:17) Sent: matz pato (23:17): /w matz wewerwe
(23:17) Received: /w matz asdsdasads 432 5wefgd g5 g reg
(23:17) Sent: matz pato (23:17): /w matz asdsdasads 432 5wefgd g5 g reg
(23:17) Received: all package client;

import java.awt.Color;
import java.awt.Component;
import java.awt.Font;
import java.awt.Point;
import java.awt.Rectangle;
import java.awt.event.ActionEvent;
import java.awt.event.FocusAdapter;
import java.awt.event.FocusEvent;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.io.FileInputStream;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.AbstractAction;
import javax.swing.Action;
import javax.swing.GroupLayout;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JList;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.JTextPane;
import javax.swing.KeyStroke;
import javax.swing.LayoutStyle;
import javax.swing.ListCellRenderer;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.text.AttributeSet;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;
import javax.swing.text.PlainDocument;
import javax.swing.text.SimpleAttributeSet;
import javax.swing.text.StyleConstants;
import javazoom.jl.player.Player;

public class GUI
{
	private ArrayList<User> userlist = new ArrayList<User>();
	private ArrayList<History> history = new ArrayList<History>();
	private int historySize;
	private int historyIndex;
	private boolean viewingHistory;
	private boolean viewedUp;
	private boolean viewedDown;
	private int displayTimer = 0;
	private JFrame jframe;
	private Client client;
	private JMenuBar jMenuBar1;
	private JMenu jMenu1;
	private JMenuItem jMenuItem1;
	private JMenuItem jMenuItem2;
	private JMenuItem jMenuItem3;
	private JList jList1;
	private JScrollPane jScrollPane1;
	private JScrollPane jScrollPane2;
	private JScrollPane jScrollPane3;
	private JTextPane jTextArea1;
	private JTextArea jTextArea2;
	private SimpleAttributeSet nameSet = new SimpleAttributeSet();
	private SimpleAttributeSet serverSet = new SimpleAttributeSet();
	private SimpleAttributeSet infoSet = new SimpleAttributeSet();
	private Document doc;
	private int currentTime = 0;
	private int lastTimeSent = -10;
	private int new_messageIndex = 1;

	/*@SuppressWarnings("serial")
	private Action enter = new AbstractAction("Enter") {
		public synchronized void actionPerformed(ActionEvent e) {
			try {
				if (Math.abs(currentTime-lastTimeSent)>=0){
					System.out.println(shiftKeyPressed);
					decodeInput(jTextArea2);
				}
			}
			catch (Exception e1)
			{
				e1.printStackTrace();
			}
		}
	};*/

	public GUI(Client client, String title)
	{
		init(title);
		initComponents();
		this.client = client;
	}

	public synchronized void init(String title) {
		jframe = new JFrame(title);
		try {
			for (UIManager.LookAndFeelInfo info : UIManager.getInstalledLookAndFeels())
				if ("Windows".equals(info.getName())) {
					UIManager.setLookAndFeel(info.getClassName());
					break;
				}
		} catch (ClassNotFoundException ex) {
			Logger.getLogger(GUI.class.getName()).log(Level.SEVERE, null, ex); } catch (InstantiationException ex) {
				Logger.getLogger(GUI.class.getName()).log(Level.SEVERE, null, ex); } catch (IllegalAccessException ex) {
					Logger.getLogger(GUI.class.getName()).log(Level.SEVERE, null, ex); } catch (UnsupportedLookAndFeelException ex) {
						Logger.getLogger(GUI.class.getName()).log(Level.SEVERE, null, ex);
					}
	}

	private synchronized void initComponents() {
		jMenuBar1 = new JMenuBar();
		jMenu1 = new JMenu();
		jMenuItem1 = new JMenuItem();
		jMenuItem2 = new JMenuItem();
		jMenuItem3 = new JMenuItem();
		jTextArea1 = new JTextPane();
		jTextArea2 = new JTextArea();
		jScrollPane1 = new JScrollPane();
		jScrollPane2 = new JScrollPane();
		jScrollPane3 = new JScrollPane();
		jList1 = new JList();

		Font font = new Font("Arial", 0, 16);
		doc = jTextArea1.getStyledDocument();
		
		jTextArea1.setFont(font);
		jTextArea2.setFont(font);
		jTextArea1.setForeground(new Color(0.15F, 0.15F, 0.15F));
		jTextArea2.setForeground(new Color(0.15F, 0.15F, 0.15F));
		jTextArea1.setEditable(false);
		jTextArea2.setLineWrap(true);
		jList1.setFont(font);
		jList1.setCellRenderer(new CellRenderer());
		jframe.setLocation(658, 40);
		jframe.setResizable(true);
		jTextArea2.addKeyListener(new KeyInput());
		jTextArea2.setEnabled(false);
		jTextArea2.setBackground(new Color(225, 225, 225));
		jTextArea2.setText("Please log in first.");
		jframe.setDefaultCloseOperation(3);
		jScrollPane1.setViewportView(jList1);

		jScrollPane2.setViewportView(jTextArea1);

		jTextArea2.setColumns(20);
		jTextArea2.setRows(4);
		jScrollPane3.setViewportView(jTextArea2);

		/*jTextArea2.getInputMap().put(KeyStroke.getKeyStroke(10, 0), "Enter");
		jTextArea2.getActionMap().put("Enter", enter);*/

		jMenuItem1.setText("Connect...");
		jMenuItem2.setText("Login...");
		jMenuItem3.setText("Exit");
		jMenu1.add(jMenuItem1);		
		jMenu1.add(jMenuItem2);
		jMenu1.add(jMenuItem3);
		jMenu1.setText("Start");
		jMenuBar1.add(jMenu1);
		jframe.setJMenuBar(jMenuBar1);
		jTextArea2.addFocusListener(new FocusAdapter() {
			public void focusGained(FocusEvent e) {
				if (jTextArea2.getText().equals("Type a message...")){
					jTextArea2.setForeground(new Color(0.1f,0.1f,0.1f));
					jTextArea2.setText("");
				}
				else {
					jTextArea2.setForeground(new Color(0.1f,0.1f,0.1f));
				}
			}
			public void focusLost(FocusEvent e) {
				if (jTextArea2.getText().length()==0){
					jTextArea2.setForeground(new Color(0.5f,0.5f,0.5f));
					jTextArea2.setText("Type a message...");
				}
			}
		});

		jList1.addMouseListener(new MouseAdapter() {
			public void mouseClicked(MouseEvent evt) {
				jList1 = (JList)evt.getSource();
				if (evt.getClickCount() >= 2) {
					int index = jList1.locationToIndex(evt.getPoint());
					if (jList1.getModel().getSize()>0){
						String selectedUser = jList1.getModel().getElementAt(index).toString();
						jTextArea2.setText("/w "+selectedUser+" ");
					}
					jTextArea2.requestFocusInWindow();
				}
			}
		});

		jMenuItem1.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jMenuItem1ActionPerformed(evt);
			}
		});

		jMenuItem2.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jMenuItem2ActionPerformed(evt);
			}
		});

		jMenuItem3.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jMenuItem3ActionPerformed(evt);
			}
		});

		GroupLayout layout = new GroupLayout(jframe.getContentPane());
		jframe.getContentPane().setLayout(layout);
		layout.setHorizontalGroup(
				layout.createParallelGroup(GroupLayout.Alignment.LEADING)
				.addGroup(layout.createSequentialGroup()
						.addContainerGap()
						.addComponent(jScrollPane1, GroupLayout.PREFERRED_SIZE, 120, GroupLayout.PREFERRED_SIZE)
						.addPreferredGap(LayoutStyle.ComponentPlacement.UNRELATED)
						.addGroup(layout.createParallelGroup(GroupLayout.Alignment.TRAILING)
								.addComponent(jScrollPane2, GroupLayout.DEFAULT_SIZE, 514, Short.MAX_VALUE)
								.addComponent(jScrollPane3, GroupLayout.DEFAULT_SIZE, 514, Short.MAX_VALUE))
								.addContainerGap())
				);
		layout.setVerticalGroup(
				layout.createParallelGroup(GroupLayout.Alignment.LEADING)
				.addGroup(layout.createSequentialGroup()
						.addContainerGap()
						.addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
								.addComponent(jScrollPane1, GroupLayout.DEFAULT_SIZE, 383, Short.MAX_VALUE)
								.addGroup(GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
										.addComponent(jScrollPane2, GroupLayout.DEFAULT_SIZE, 299, Short.MAX_VALUE)
										.addPreferredGap(LayoutStyle.ComponentPlacement.RELATED)
										.addComponent(jScrollPane3, GroupLayout.PREFERRED_SIZE, 125, GroupLayout.PREFERRED_SIZE)))
										.addContainerGap())
				);
		jframe.setVisible(true);
		jframe.pack();		
		jTextArea2.requestFocusInWindow();
	}

	private void jMenuItem1ActionPerformed(ActionEvent evt) {
		new MenuWindow("Connect...", "Enter IP Address:", "Connect", "Connect", jTextArea2);
	}

	private void jMenuItem2ActionPerformed(ActionEvent evt) {
		new MenuWindow("Login...", "Enter username:", "Log in", "Login", jTextArea2);
	}

	private void jMenuItem3ActionPerformed(ActionEvent evt) {
		System.exit(0);
	}

	public synchronized void updateChat(String receiver, String sender, String time, String command, String user, String message)
	{
		lastTimeSent = getCurrentTime();
		try {
			if (sender.equals("server")) {
				if (command.equals("loginerror")) {
					StyleConstants.setForeground(serverSet, new Color(0, 180, 0));
					StyleConstants.setBold(serverSet, true);
					doc.insertString(doc.getLength(), "\n"+sender+" "+time+" "+user+" "+message, serverSet);
					playSound("serverNotification1");
				}
				else if (command.equals("username")) {
					client.setUsername(user);
					jframe.setTitle(client.getAppName()+"-"+user);
					updateChat("", "", "", "", "", "You're now logged in as "+user+".");
					playSound("login2");
					toggleChatInput();
					toggleLoginMenu();
				}
				else if (command.equals("update")) {
					updateUserList(user+" "+message);
				}
			}
			else if (command.equals("/w")) {
				if (sender.equals(client.getUsername())) {
					StyleConstants.setForeground(nameSet, new Color(50, 50, 180));
					StyleConstants.setBold(nameSet, true);
					doc.insertString(doc.getLength(), "\n", null);
					doc.insertString(doc.getLength(), "[To "+receiver+"] ", nameSet);
					StyleConstants.setBold(nameSet, false);
					doc.insertString(doc.getLength(), time+" "+message, nameSet);
					StyleConstants.setItalic(nameSet, false);
				}
				else {
					StyleConstants.setForeground(nameSet, findUserByName(sender).getColor());
					StyleConstants.setBold(nameSet, true);
					doc.insertString(doc.getLength(), "\n", null);
					doc.insertString(doc.getLength(), "[From "+sender+"] ", nameSet);
					StyleConstants.setBold(nameSet, false);
					doc.insertString(doc.getLength(), time+" "+message, nameSet);
					StyleConstants.setItalic(nameSet, false);
				}
				playSound("new_privateMessage1");
			}
			else if (command.equals("all")) {
				if (sender.equals(client.getUsername())) {
					StyleConstants.setForeground(nameSet, new Color(50, 50, 180));
					StyleConstants.setUnderline(nameSet, true);
				}
				else {
					StyleConstants.setForeground(nameSet, findUserByName(sender).getColor());
				}
				jTextArea1.setCharacterAttributes(nameSet, true);
				doc.insertString(doc.getLength(), "\n", null);
				doc.insertString(doc.getLength(), (sender+" "+time+ " "+user+" "+message).trim(), nameSet);
				if (new_messageIndex>3) {
					new_messageIndex = 1;
				}
				playSound("new_message"+new_messageIndex);
				new_messageIndex+=1;
			}
			else if ((sender.equals("")) && (time.equals("")) && (command.equals("")) && (user.equals(""))) {
				if (receiver.equals("notification")) {
					playSound("serverNotification1");
				}
				StyleConstants.setForeground(infoSet, new Color(140, 140, 255));
				StyleConstants.setBold(infoSet, true);
				if (jTextArea1.getText().length()<=0){
					doc.insertString(doc.getLength(), message, infoSet);
				}
				else {
					doc.insertString(doc.getLength(), "\n", null);
					doc.insertString(doc.getLength(), message, infoSet);
				}				
			}

			SwingUtilities.invokeLater(new Runnable() {
				public void run() {
					jTextArea1.scrollRectToVisible(new Rectangle(0, jTextArea1.getHeight()-2, 1, 1));
				}
			});
		}
		catch (Exception e1) {
			//e1.printStackTrace();
		}
	}

	public synchronized User findUserByName(String name) {
		User user = null;
		for (int i = 0; i<userlist.size(); i++) {
			if (userlist.get(i).getName().equals(name)) {
				user = (User)userlist.get(i);
			}
		}
		return user;
	}

	public synchronized void decodeInput(JTextArea textDisplay) throws IOException {
		char[] msgToDecode = textDisplay.getText().toCharArray();
		String command = "";
		String message = "";
		String user = "";
		int spaces = 0;
		for (int i=0;i<textDisplay.getText().length();i++) {
			char current = msgToDecode[i];
			if (current==' ') {
				spaces++;
			}
			if ((spaces==0) && (current != ' ')) {
				command = command.concat(Character.toString(current));
			}
			if ((spaces==1) && (current != ' ')) {
				user = user.concat(Character.toString(current));
			}
			if (spaces >= 2) {
				message = message.concat(Character.toString(current));
			}
		}
		user = user.trim();
		message = message.trim();
		System.out.println("<c:>"+command+"<u:>"+user+"<m:>"+message);
		if (command.equals("/w") && !user.equals("")) {
			clearDisplay(jTextArea2);
			client.send(command+" "+user+" "+message);
			updateHistory(command, user, message);
		}
		else if (jTextArea2.getText().length()>0 && !client.getUsername().equals("")) {
			clearDisplay(jTextArea2);
			client.send("all "+command+" "+user+" "+message);
			updateHistory(command, user, message);
		}
	}

	public synchronized void updateHistory(String command, String user, String message)
	{
		String result = "";
		command = command.trim();
		user = user.trim();
		message = message.trim();
		if ((message.length()<=0) && (user.length()<=0)) {
			result = command+user+message;
		}
		else if ((message.length()<=0) && (user.length()>0)) {
			result = command+" "+user+message;
		}
		else {
			result = command+" "+user+" "+message;
		}
		history.add(new History(result));
		historySize+=1;
		historyIndex = historySize;
		viewingHistory = false;
		viewedUp = false;
		viewedDown = false;
	}

	public synchronized boolean userAlreadyExists(String name) {
		boolean exists = false;
		for (int i = 0; i<userlist.size(); i++) {
			if (userlist.get(i).getName().equals(name)) {
				exists = true;
				break;
			}
		}

		return exists;
	}

	public synchronized void updateUserList(String newList)
	{
		String[] userList = new String[0];
		String name = "";
		char[] msgToDecode = newList.toCharArray();

		int users = 0;
		if (newList.length()>0) {
			users = 0;
			for (int i = 0; i<newList.length(); i++) {
				char current = msgToDecode[i];
				if (current==' ') {
					users++;
				}
			}
			if (users>1) {
				userList = new String[users-1];
				users = 0;
				for (int i = 0; i<newList.length(); i++) {
					char current = msgToDecode[i];
					if ((current==' ') && 
							(name.length()>0)) {
						if (!name.equals(client.getUsername())) {
							userList[users] = name;
							if (!userAlreadyExists(name)) {
								userlist.add(new User(name));
							}
							name = "";
							users++;
						}
						else {
							name = "";
						}
					}

					if (current != ' ') {
						name = name.concat(Character.toString(current));
					}
				}
				jList1.setListData(userList);
			}
			else {
				jList1.setListData(userList);
			}
		}
	}

	public synchronized void clearUserlist(){
		String[] userList = new String[0];
		jList1.setListData(userList);
		userlist.clear();
	}

	public synchronized void cleanUserlist(String[] jUserlist)
	{
		SwingUtilities.invokeLater(new Runnable() {
			public void run() {
				//System.out.println("ArraySize:"+userlist.size());
				System.out.println("Model:"+jList1.getModel().getSize());

				for (int i=0; i<userlist.size();i++) {
					boolean exists = false;
					for (int j= 0;j<jList1.getModel().getSize();j++) {
						System.out.println("Array Index:"+i);
						System.out.println("Model Index:"+j);
						if (userlist.get(i).getName().equals(jList1.getModel().getElementAt(j))) {
							userlist.get(j).setConnected(true);
							exists = true;
							break;
						}
						if (!exists) {
							userlist.get(j).setConnected(false);
						}
					}
				}
				for (int i = 0; i<userlist.size(); i++) {
					System.out.println("Array content:"+i+"-->"+userlist.get(i).getName());
					if (!userlist.get(i).isConnected()) {
						System.out.println("User "+userlist.get(i).getName()+" has been removed.");
						userlist.remove(i);
					}
				}
			}
		});
	}

	public synchronized void updateDisplay(String msg, JTextArea textDisplay) {
		displayTimer-=1;
		if (displayTimer<=0) {
			textDisplay.append(msg+"\n");
			textDisplay.setCaretPosition(textDisplay.getText().length());
			displayTimer = 0;
		}
	}

	public synchronized void clearDisplay(JTextArea textDisplay) {
		textDisplay.setText("");
	}

	public synchronized void resetCaretPosition(JTextArea textDisplay) {
		if (textDisplay.getCaretPosition()<textDisplay.getText().length())
			textDisplay.setCaretPosition(textDisplay.getText().length());
	}

	public synchronized void playSound(String sound){			
		FileInputStream music;
		try {
			music = new FileInputStream("resources/"+sound+".mp3");
			final Player mp3 = new Player(music);
			new Thread() {
				public void run() {
					try {mp3.play(); }
					catch (Exception e) { System.out.println(e); }
				}
			}.start();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public synchronized void toggleConnectMenu() {
		if (jMenuItem1.isEnabled()) {
			jMenuItem1.setEnabled(false);
		}
		else
			jMenuItem1.setEnabled(true);
	}

	public synchronized void toggleLoginMenu()
	{
		if (jMenuItem2.isEnabled()) {
			jMenuItem2.setEnabled(false);
		}
		else
			jMenuItem2.setEnabled(true);
	}

	public synchronized void toggleChatInput()
	{
		if ((jTextArea2.isEnabled()) && (jTextArea2.isEditable())) {
			jTextArea2.setBackground(new Color(225, 225, 225));
			jTextArea2.setEnabled(false);
			jTextArea2.setEditable(false);
			jTextArea2.setText("Please log in first.");
		}
		else {
			jTextArea2.setBackground(new Color(255, 255, 255));
			jTextArea2.setEnabled(true);
			jTextArea2.setEditable(true);
			jTextArea2.setText("");
			jTextArea2.requestFocusInWindow();
		}
	}

	public synchronized int getCurrentTime() {
		Calendar currentDate = Calendar.getInstance();
		SimpleDateFormat formatter = new SimpleDateFormat("ss");
		String timeNow = formatter.format(currentDate.getTime());
		return Integer.parseInt(timeNow);
	}

	public synchronized void setCurrentTime(int currentTime) {
		this.currentTime = currentTime;
	}

	public synchronized JFrame getJframe() {
		return jframe;
	}

	private class CellRenderer
	implements ListCellRenderer
	{
		private JLabel jLabel1 = new JLabel();
		private Font font = new Font("Arial", 0, 16);

		public CellRenderer() {
			jLabel1.setOpaque(true);
		}

		public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus)
		{
			jLabel1.setText(jList1.getModel().getElementAt(index).toString());
			jLabel1.setFont(font);
			if (isSelected) {
				jLabel1.setBackground(Color.white);
				jLabel1.setForeground(((User)userlist.get(index)).getColor());
			} else {
				jLabel1.setBackground(Color.white);
				jLabel1.setForeground(((User)userlist.get(index)).getColor());
			}
			return jLabel1;
		}
	}

	private class JTextFieldLimit extends PlainDocument
	{
		private int limit;

		JTextFieldLimit(int limit)
		{
			this.limit = limit;
		}

		public synchronized void insertString(int offset, String str, AttributeSet attr) throws BadLocationException {
			if (str==null) return;
			if (getLength()+str.length()<=limit)
				super.insertString(offset, str, attr);
		}
	}

	private class KeyInput extends KeyAdapter {
		private boolean shiftKey = false;
		public synchronized void keyPressed(KeyEvent e) {
			if (e.getKeyCode()==KeyEvent.VK_UP) {
				if (!viewingHistory) {
					if (historyIndex<historySize) {
						jTextArea2.setText(history.get(historyIndex).getMessage());
					}
					else {
						jTextArea2.setText(history.get(historyIndex-1).getMessage());
					}

				}
				else if (viewedDown) {
					if (historySize>0) {
						if (historyIndex>0) {
							historyIndex-=1;
						}
						jTextArea2.setText(history.get(historyIndex-1).getMessage());
					}
				}
				else {
					if (historyIndex>0) {
						historyIndex-=1;
					}
					if (historyIndex<=0) {
						historyIndex = 1;
					}
					jTextArea2.setText(history.get(historyIndex-1).getMessage());
				}

				viewedUp = true;
				viewedDown = false;
				viewingHistory = true;
			}
			if (e.getKeyCode()==KeyEvent.VK_DOWN) {
				if (!viewingHistory) {
					if (historyIndex<historySize) {
						jTextArea2.setText(history.get(historyIndex).getMessage());
					}
					else {
						jTextArea2.setText(history.get(historyIndex-1).getMessage());
					}

				}
				else if (viewedUp) {
					if (historyIndex<historySize) {
						historyIndex+=1;
					}
					jTextArea2.setText(history.get(historyIndex-1).getMessage());
				}
				else
				{
					if (historyIndex<historySize) {
						historyIndex+=1;
					}
					jTextArea2.setText(history.get(historyIndex-1).getMessage());
				}

				viewedUp = false;
				viewedDown = true;
				viewingHistory = true;
			}
			if (e.getKeyCode()==KeyEvent.VK_ENTER) {
				try {
					if (shiftKey==true){
						jTextArea2.append("\n");
					}
					else {
						if (Math.abs(currentTime-lastTimeSent)>=1){
							decodeInput(jTextArea2);	
						}
					}					
				} catch (Exception e1) {
					e1.printStackTrace();
				}
				jTextArea2.setCaretPosition(-1);
			}
			if (e.getKeyCode()==KeyEvent.VK_SHIFT) {
				shiftKey = true;
			}
		}
		public synchronized void keyReleased(KeyEvent e) {
			if (e.getKeyCode()==KeyEvent.VK_SHIFT) {
				shiftKey = false;
			}			
		}
	}

	private class MenuWindow {
		private JFrame CWjframe;
		private JButton jButton1;
		private JLabel jLabel1;
		private JTextField jTextField1;
		private String title;
		private String labelText;
		private String buttonText;
		private String action;
		private JTextArea jTextArea2;

		public MenuWindow(String title, String labelText, String buttonText, String action, JTextArea jTextArea2){
			this.title = title;
			this.labelText = labelText;
			this.buttonText = buttonText;
			this.action = action;
			this.jTextArea2 = jTextArea2;
			initComponents();
		}

		public void initComponents() {
			CWjframe = new JFrame();
			Font font = new Font("Arial", Font.PLAIN, 12);
			jLabel1 = new JLabel();
			jTextField1 = new JTextField();
			jButton1 = new JButton();

			CWjframe.setIgnoreRepaint(false);
			CWjframe.setAlwaysOnTop(true);
			CWjframe.setTitle(title);
			Point jframeLocation = getJframe().getLocation();
			int locX = (int)jframeLocation.getX();
			int locY = (int)jframeLocation.getY();
			CWjframe.setLocation(locX+20, locY+30);

			jLabel1.setText(labelText);
			jLabel1.setFont(font);
			jTextField1.setText("");
			jTextField1.setFont(font);			
			jTextField1.requestFocusInWindow();
			jButton1.setText(buttonText);
			jButton1.setFont(font);

			if (action.equals("Login")) {
				jTextField1.setDocument(new JTextFieldLimit(12));
				jButton1.setEnabled(false);
				jTextField1.getDocument().addDocumentListener(new DocumentListener() {					
					public void changedUpdate(DocumentEvent e) {

					}
					public void removeUpdate(DocumentEvent e) {	
						int spaces = 0;
						boolean invalid = false;
						String username = jTextField1.getText();
						char[] username2 = username.toCharArray();
						for (int i=0;i<username.length();i++){
							char current = username2[i];
							if(current==' '){
								spaces++;
							}
							else if (current=='\t') {
								invalid = true;
							}
						}
						if (username.length()<3 || spaces>1 || invalid==true){
							jTextField1.setForeground(new Color(255,0,0));
							jButton1.setEnabled(false);
						}
						else {
							jTextField1.setForeground(new Color(0,0,0));
							jButton1.setEnabled(true);
						}						
					}
					public void insertUpdate(DocumentEvent e) {	
						int spaces = 0;
						boolean invalid = false;
						String username = jTextField1.getText();
						char[] username2 = username.toCharArray();
						for (int i=0;i<username.length();i++){
							char current = username2[i];
							if(current==' '){
								spaces++;
							}
							else if (current=='\t') {
								invalid = true;
							}
						}
						if (username.length()<3 || spaces>1 || invalid==true){
							jTextField1.setForeground(new Color(255,0,0));
							jButton1.setEnabled(false);
						}
						else {
							jTextField1.setForeground(new Color(0,0,0));
							jButton1.setEnabled(true);
						}
					}
				});
			}


			jButton1.addActionListener(new java.awt.event.ActionListener() {
				public void actionPerformed(java.awt.event.ActionEvent evt) {
					try {jButton1ActionPerformed(evt);
					} catch (IOException e) {}
				}
			});

			CWjframe.getRootPane().setDefaultButton(jButton1);

			javax.swing.GroupLayout layout = new javax.swing.GroupLayout(CWjframe.getContentPane());
			CWjframe.getContentPane().setLayout(layout);
			layout.setHorizontalGroup(
					layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
					.addGroup(layout.createSequentialGroup()
							.addContainerGap()
							.addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
									.addComponent(jLabel1)
									.addComponent(jTextField1, javax.swing.GroupLayout.DEFAULT_SIZE, 213, Short.MAX_VALUE)
									.addComponent(jButton1, javax.swing.GroupLayout.Alignment.TRAILING))
									.addContainerGap())
					);
			layout.setVerticalGroup(
					layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
					.addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
							.addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
							.addComponent(jLabel1)
							.addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
							.addComponent(jTextField1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
							.addGap(7, 7, 7)
							.addComponent(jButton1)
							.addContainerGap())
					);
			CWjframe.setVisible(true);
			CWjframe.pack();
		}// end initComponents()

		private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) throws IOException {
			if (action.equals("Connect")){
				client.connect(jTextField1.getText());
				CWjframe.dispose();
				if (!client.getHost().equals("")){
					new MenuWindow("Login...","Enter username:","Log in","Login", jTextArea2);
				}
				else {
					new MenuWindow("Connect...", "Enter IP Address:", "Connect", "Connect", jTextArea2);
				}				
			}
			else if (action.equals("Login")){
				String username = jTextField1.getText();
				username = username.replace(' ', '_');
				if (username.length()>=3){
					client.send("login"+" "+username);
					CWjframe.dispose();
					jTextArea2.requestFocusInWindow();
				}				
			}
		}
	}
}
(23:17) Sent: Connection: matz has disconnected.
(23:17) Sent: user server update pato 
(23:17) Sent: Connection: pato has disconnected.
(23:21) Received: login PATO
(23:21) Sent: user server update PATO 
(23:21) Received: all hola  
(23:21) Sent: all PATO (23:21): all hola  
(23:21) Received: all como va 
(23:21) Sent: all PATO (23:21): all como va 
(23:21) Sent: Connection: PATO has disconnected.
(23:21) Received: login pato
(23:21) Sent: user server update pato 
(23:21) Received: all hola  
(23:21) Sent: all pato (23:21): all hola  
(23:21) Received: all  como va
(23:21) Sent: all pato (23:21): all  como va
(23:21) Sent: Connection: pato has disconnected.
(23:22) Received: login pato
(23:22) Sent: user server update pato 
(23:22) Received: all af  
(23:22) Sent: all pato (23:22): all af  
(23:22) Sent: Connection: pato has disconnected.
(23:23) Received: login pato
(23:23) Sent: user server update pato 
(23:23) Received: all asddas  
(23:23) Sent: all pato (23:23): all asddas  
(23:23) Received: all addasasas  
(23:23) Sent: all pato (23:23): all addasasas  
(23:23) Received: all asdassadsa  
(23:23) Sent: all pato (23:23): all asdassadsa  
(23:23) Sent: Connection: pato has disconnected.
(23:24) Received: login pato
(23:24) Sent: user server update pato 
(23:24) Received: all hola como va
(23:24) Sent: all pato (23:24): all hola como va
(23:24) Received: all asda  
(23:24) Sent: all pato (23:24): all asda  
(23:24) Received: all sdasdas  
(23:24) Sent: all pato (23:24): all sdasdas  
(23:25) Received: login pato
(23:26) Sent: Connection: pato has disconnected.
(23:26) Received: login pato
(23:26) Sent: user server update pato 
(23:26) Received: all hola  
(23:26) Sent: all pato (23:26): all hola  
(23:26) Received: all 
  
(23:26) Sent: all pato (23:26): all 
  
(23:26) Received: all 
  
(23:26) Sent: all pato (23:26): all 
  
(23:26) Received: all 
  
(23:26) Sent: all pato (23:26): all 
  
(23:26) Received: all 

  
(23:26) Sent: all pato (23:26): all 

  
(23:26) Received: all 
  
(23:26) Sent: all pato (23:26): all 
  
(23:26) Received: all 
  
(23:26) Sent: all pato (23:26): all 
  
(23:26) Received: all 
  
(23:26) Sent: all pato (23:26): all 
  
(23:26) Sent: Connection: pato has disconnected.
(23:26) Received: login pato
(23:26) Sent: user server update pato 
(23:26) Received: all ad  
(23:26) Sent: all pato (23:26): all ad  
(23:26) Sent: Connection: pato has disconnected.
(23:27) Received: login pato
(23:27) Sent: user server update pato 
(23:27) Received: all 
  
(23:27) Sent: all pato (23:27): all 
  
(23:27) Received: all 



  
(23:27) Sent: all pato (23:27): all 



  
(23:27) Received: all 
sdadas  
(23:27) Sent: all pato (23:27): all 
sdadas  
(23:27) Received: all 
asddsa  
(23:27) Sent: all pato (23:27): all 
asddsa  
(23:27) Sent: Connection: pato has disconnected.
(23:27) Received: login pato
(23:27) Sent: user server update pato 
(23:27) Received: all addasdas  
(23:27) Sent: all pato (23:27): all addasdas  
(23:34) Received: all asd  
(23:34) Sent: all pato (23:34): all asd  
(23:34) Received: all asdasdasdsad  
(23:34) Sent: all pato (23:34): all asdasdasdsad  
(23:34) Received: all ewrerewerwe  
(23:34) Sent: all pato (23:34): all ewrerewerwe  
